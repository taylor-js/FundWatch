@model FundWatch.Models.ViewModels.PortfolioDashboardViewModel
@using FundWatch.Models
@using Syncfusion.EJ2
@using Syncfusion.EJ2.Navigations
@using Syncfusion.EJ2.Charts
@using Syncfusion.EJ2.Grids

@* Explicitly reference correct TabItem from all available libraries *@
@using TabHeader = Syncfusion.EJ2.Navigations.TabHeader
@{
    ViewData["Title"] = "Stock Portfolio Dashboard";
    var culture = new System.Globalization.CultureInfo("en-US");
    
    // Check for API configuration issues
    bool hasApiError = TempData["ApiError"] != null;
    bool hasPerformanceData = Model.PerformanceData != null && Model.PerformanceData.Any() && 
                              Model.PerformanceData.Any(kvp => kvp.Value != null && kvp.Value.Any());
}

<div class="container mt-4 mb-4" id="dashboard-container">
    <!-- Global loading indicator removed since we're using component-specific loading -->

    <!-- Tab Navigation - loaded as a partial view -->
    @await Html.PartialAsync("_DashboardTabs")

    <!-- Tab Content Container -->
    <div class="tab-content" id="dashboardTabContent">
    
        <!-- Tab Content: Overview -->
        <div id="overviewTab" class="tab-pane fade show active" role="tabpanel">
            @await Html.PartialAsync("_OverviewTab", Model)
        </div>

        <!-- Tab Content: Performance -->
        <div id="performanceTab" class="tab-pane fade" role="tabpanel">
            @await Html.PartialAsync("_PerformanceTab", Model)
        </div>

        <!-- Tab Content: Analytics -->
        <div id="analyticsTab" class="tab-pane fade" role="tabpanel">
            @await Html.PartialAsync("_AnalyticsTab", Model)
        </div>

        <!-- Tab Content: Holdings -->
        <div id="holdingsTab" class="tab-pane fade" role="tabpanel">
            @await Html.PartialAsync("_HoldingsTab", Model)
        </div>
    </div>
</div>

@section Scripts {
    @await Html.PartialAsync("_DashboardScripts")
}